!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.minnow=n():t.minnow=n()}(window,function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"BACKSPACE",function(){return i}),e.d(r,"TAB",function(){return u}),e.d(r,"ENTER",function(){return o}),e.d(r,"SHIFT",function(){return s}),e.d(r,"CTRL",function(){return d}),e.d(r,"ALT",function(){return c}),e.d(r,"PAUSE_BREAK",function(){return a}),e.d(r,"CAPSLOCK",function(){return h}),e.d(r,"ESCAPE",function(){return _}),e.d(r,"SPACE",function(){return f}),e.d(r,"PAGE_UP",function(){return l}),e.d(r,"PAGE_DOWN",function(){return E}),e.d(r,"END",function(){return p}),e.d(r,"HOME",function(){return y}),e.d(r,"LEFT_ARROW",function(){return K}),e.d(r,"UP_ARROW",function(){return A}),e.d(r,"RIGHT_ARROW",function(){return w}),e.d(r,"DOWN_ARROW",function(){return T}),e.d(r,"INSERT",function(){return g}),e.d(r,"DELETE",function(){return U}),e.d(r,"ZERO",function(){return b}),e.d(r,"ONE",function(){return O}),e.d(r,"TWO",function(){return N}),e.d(r,"THREE",function(){return m}),e.d(r,"FOUR",function(){return C}),e.d(r,"FIVE",function(){return I}),e.d(r,"SIX",function(){return R}),e.d(r,"SEVEN",function(){return M}),e.d(r,"EIGHT",function(){return P}),e.d(r,"NINE",function(){return L}),e.d(r,"A_KEY",function(){return B}),e.d(r,"B_KEY",function(){return S}),e.d(r,"C_KEY",function(){return D}),e.d(r,"D_KEY",function(){return F}),e.d(r,"E_KEY",function(){return G}),e.d(r,"F_KEY",function(){return Y}),e.d(r,"G_KEY",function(){return v}),e.d(r,"H_KEY",function(){return x}),e.d(r,"I_KEY",function(){return H}),e.d(r,"J_KEY",function(){return W}),e.d(r,"K_KEY",function(){return k}),e.d(r,"L_KEY",function(){return j}),e.d(r,"M_KEY",function(){return V}),e.d(r,"N_KEY",function(){return Q}),e.d(r,"O_KEY",function(){return X}),e.d(r,"P_KEY",function(){return Z}),e.d(r,"Q_KEY",function(){return q}),e.d(r,"R_KEY",function(){return $}),e.d(r,"S_KEY",function(){return z}),e.d(r,"T_KEY",function(){return J}),e.d(r,"U_KEY",function(){return tt}),e.d(r,"V_KEY",function(){return nt}),e.d(r,"W_KEY",function(){return et}),e.d(r,"X_KEY",function(){return rt}),e.d(r,"Y_KEY",function(){return it}),e.d(r,"Z_KEY",function(){return ut}),e.d(r,"LEFT_WINDOW",function(){return ot}),e.d(r,"RIGHT_WINDOW",function(){return st}),e.d(r,"SELECT",function(){return dt}),e.d(r,"NUM_ZERO",function(){return ct}),e.d(r,"NUM_ONE",function(){return at}),e.d(r,"NUM_TWO",function(){return ht}),e.d(r,"NUM_THREE",function(){return _t}),e.d(r,"NUM_FOUR",function(){return ft}),e.d(r,"NUM_FIVE",function(){return lt}),e.d(r,"NUM_SIX",function(){return Et}),e.d(r,"NUM_SEVEN",function(){return pt}),e.d(r,"NUM_EIGHT",function(){return yt}),e.d(r,"NUM_NINE",function(){return Kt}),e.d(r,"MULTIPLY",function(){return At}),e.d(r,"ADD",function(){return wt}),e.d(r,"SUBTRACT",function(){return Tt}),e.d(r,"DECIMAL_POINT",function(){return gt}),e.d(r,"DIVIDE",function(){return Ut}),e.d(r,"F1",function(){return bt}),e.d(r,"F2",function(){return Ot}),e.d(r,"F3",function(){return Nt}),e.d(r,"F4",function(){return mt}),e.d(r,"F5",function(){return Ct}),e.d(r,"F6",function(){return It}),e.d(r,"F7",function(){return Rt}),e.d(r,"F8",function(){return Mt}),e.d(r,"F9",function(){return Pt}),e.d(r,"F10",function(){return Lt}),e.d(r,"F11",function(){return Bt}),e.d(r,"F12",function(){return St}),e.d(r,"NUM_LOCK",function(){return Dt}),e.d(r,"SCROLL_LOCK",function(){return Ft}),e.d(r,"SEMI_COLON",function(){return Gt}),e.d(r,"EQUAL_SIGN",function(){return Yt}),e.d(r,"COMMA",function(){return vt}),e.d(r,"DASH",function(){return xt}),e.d(r,"PERIOD",function(){return Ht}),e.d(r,"FORWARD_SLASH",function(){return Wt}),e.d(r,"GRAVE_ACCENT",function(){return kt}),e.d(r,"OPEN_BRACKET",function(){return jt}),e.d(r,"BACK_SLASH",function(){return Vt}),e.d(r,"CLOSE_BRACKET",function(){return Qt}),e.d(r,"SINGLE_QUOTE",function(){return Xt}),e.d(r,"GAME_LEFT",function(){return Zt}),e.d(r,"GAME_RIGHT",function(){return qt}),e.d(r,"GAME_UP",function(){return $t}),e.d(r,"GAME_DOWN",function(){return zt}),e.d(r,"GAME_ACTION_ONE",function(){return Jt}),e.d(r,"GAME_ACTION_TWO",function(){return tn}),e.d(r,"GAME_ACTION_THREE",function(){return nn}),e.d(r,"GAME_ACTION_FOUR",function(){return en}),e.d(r,"GAME_PAUSE",function(){return rn}),e.d(r,"GAME_LEFT_TRIGGER",function(){return un}),e.d(r,"GAME_RIGHT_TRIGGER",function(){return on}),e.d(r,"MENU_LEFT",function(){return sn}),e.d(r,"MENU_RIGHT",function(){return dn}),e.d(r,"MENU_UP",function(){return cn}),e.d(r,"MENU_DOWN",function(){return an}),e.d(r,"MENU_CONFIRM",function(){return hn}),e.d(r,"MENU_BACK",function(){return _n});const i=8,u=9,o=13,s=16,d=17,c=18,a=19,h=20,_=27,f=32,l=33,E=34,p=35,y=36,K=37,A=38,w=39,T=40,g=45,U=46,b=48,O=49,N=50,m=51,C=52,I=53,R=54,M=55,P=56,L=57,B=65,S=66,D=67,F=68,G=69,Y=70,v=71,x=72,H=73,W=74,k=75,j=76,V=77,Q=78,X=79,Z=80,q=81,$=82,z=83,J=84,tt=85,nt=86,et=87,rt=88,it=89,ut=90,ot=91,st=92,dt=93,ct=96,at=97,ht=98,_t=99,ft=100,lt=101,Et=102,pt=103,yt=104,Kt=105,At=106,wt=107,Tt=109,gt=110,Ut=111,bt=112,Ot=113,Nt=114,mt=115,Ct=116,It=117,Rt=118,Mt=119,Pt=120,Lt=121,Bt=122,St=123,Dt=144,Ft=145,Gt=186,Yt=187,vt=188,xt=189,Ht=190,Wt=191,kt=192,jt=219,Vt=220,Qt=221,Xt=222,Zt=0,qt=1,$t=2,zt=3,Jt=4,tn=5,nn=6,en=7,rn=8,un=9,on=10,sn=11,dn=12,cn=13,an=14,hn=15,_n=16;var fn=class{constructor(){this.width=320,this.height=180,this.scale=3,this.transparentPaletteIndex=0,this._canvas=null,this._context=null,this._screenData=null,this._palette=null,this._generatedPalette=null,this._isLittleEndian=!0}init(){const t=document.createElement("div");t.id="main-container",this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","game-device"),this._canvas.setAttribute("width",this.width),this._canvas.setAttribute("height",this.height);let n=`width: ${this.width*this.scale}px;`;n+=`height: ${this.height*this.scale}px;`,n+="image-rendering: -webkit-optimize-contrast;",n+="image-rendering: crisp-edges;",n+="image-rendering: pixelated;",this._canvas.setAttribute("style",n),t.appendChild(this._canvas),document.body.appendChild(t),this._context=this._canvas.getContext("2d"),this._screenData=new Uint8ClampedArray(this.width*this.height);const e=new ArrayBuffer(4),r=new Uint8ClampedArray(e);new Uint32Array(e)[0]=168496141,10===r[0]&&11===r[1]&&12===r[2]&&13===r[3]&&(this._isLittleEndian=!1),this._palette||(this._palette=[[0,0,0],[0,0,0],[255,255,255],[255,0,0],[0,255,0],[0,0,255]]),this._buildPalette()}setPalette(t){this._palette=t,this._buildPalette()}setPaletteColorAtIndex(t,n){this._palette[n]=t,this._buildPalette()}_buildPalette(){this._generatedPalette=new Uint32Array(this._palette.length);let t=null;if(this._isLittleEndian)for(let n=0;n<this._palette.length;n+=1)t=this._palette[n],this._generatedPalette[n]=255<<24|t[2]<<16|t[1]<<8|t[0];else for(let n=0;n<this._palette.length;n+=1)t=this._palette[n],this._generatedPalette[n]=t[0]<<24|t[1]<<16|t[2]<<8|255}setPixel(t,n,e){t<0||t>=this.width||n<0||n>=this.height||(this._screenData[n*this.width+t]=e)}setPixelUnsafe(t,n,e){this._screenData[n*this.width+t]=e}getPixel(t,n){return this._screenData[n*this.width+t]}clear(t){t?this._screenData.fill(t):this._screenData.fill(0)}drawLine(t,n,e,r,i){t!==e||n!==r?Math.abs(r-n)<Math.abs(e-t)?t>e?this._drawLineLow(e,r,t,n,i):this._drawLineLow(t,n,e,r,i):n>r?this._drawLineHigh(e,r,t,n,i):this._drawLineHigh(t,n,e,r,i):this.setPixel(t,e,i)}_drawLineLow(t,n,e,r,i){const u=e-t;let o=r-n,s=1;o<0&&(s=-1,o=-o);let d=2*o-u,c=n;for(let n=t;n<=e;n+=1)this.setPixel(n,c,i),d>0&&(c+=s,d-=2*u),d+=2*o}_drawLineHigh(t,n,e,r,i){let u=e-t;const o=r-n;let s=1;u<0&&(s=-1,u=-u);let d=2*u-o,c=t;for(let t=n;t<=r;t+=1)this.setPixel(c,t,i),d>0&&(c+=s,d-=2*o),d+=2*u}drawScreen(){const t=this._context.getImageData(0,0,this.width,this.height),n=new ArrayBuffer(t.data.length),e=new Uint8ClampedArray(n),r=new Uint32Array(n);let i=0,u=0;for(let t=0;t<this.height;t+=1)for(let n=0;n<this.width;n+=1)u=this.height-t-1,i=this._screenData[u*this.width+n],r[t*this.width+n]=this._generatedPalette[i];t.data.set(e),this._context.putImageData(t,0,0)}};var ln=class{constructor(){this._keysRaw=new Uint8ClampedArray(256),this._currentKeys=new Uint8ClampedArray(256),this._lastKeys=new Uint8ClampedArray(256),this._buttonsToKeys=new Uint8ClampedArray(32),this._buttonsToKeys[Zt]=K,this._buttonsToKeys[qt]=w,this._buttonsToKeys[$t]=A,this._buttonsToKeys[zt]=T,this._buttonsToKeys[Jt]=ut,this._buttonsToKeys[tn]=rt,this._buttonsToKeys[nn]=B,this._buttonsToKeys[en]=z,this._buttonsToKeys[un]=q,this._buttonsToKeys[on]=et,this._buttonsToKeys[rn]=Z,this._buttonsToKeys[sn]=K,this._buttonsToKeys[dn]=w,this._buttonsToKeys[cn]=A,this._buttonsToKeys[an]=T,this._buttonsToKeys[hn]=rt,this._buttonsToKeys[_n]=ut,this._currentButtons=new Uint8ClampedArray(32),this._lastButtons=new Uint8ClampedArray(32),window.addEventListener("keydown",this.keyDown.bind(this),!1),window.addEventListener("keyup",this.keyUp.bind(this),!1)}keyDown(t){this._keysRaw[t.keyCode]=1}keyUp(t){this._keysRaw[t.keyCode]=0}pollInput(){for(let t=0;t<256;t+=1)this._lastKeys[t]=this._currentKeys[t],this._currentKeys[t]=this._keysRaw[t];this._updateButtons()}getKeyPressed(t){return!(t<0||t>=256)&&this._currentKeys[t]>0}getKeyDown(t){if(t<0||t>=256)return!1;const n=this._currentKeys[t]>0,e=this._lastKeys[t]>0;return n&&!e}getKeyUp(t){if(t<0||t>=256)return!1;const n=this._currentKeys[t]>0,e=this._lastKeys[t]>0;return!n&&e}_updateButtons(){this._updateButton("left",Zt),this._updateButton("right",qt),this._updateButton("up",$t),this._updateButton("down",zt),this._updateButton("action1",Jt),this._updateButton("action2",tn),this._updateButton("action3",nn),this._updateButton("action4",en),this._updateButton("leftTrigger",un),this._updateButton("rightTrigger",on),this._updateButton("pause",rn),this._updateButton("menuLeft",sn),this._updateButton("menuRight",dn),this._updateButton("menuUp",cn),this._updateButton("menuDown",an),this._updateButton("menuConfirm",hn),this._updateButton("menuBack",_n)}_updateButton(t,n){const e=this._buttonsToKeys[n],r=this.getKeyPressed(e),i=this.getKeyDown(e),u=this.getKeyUp(e);this[t]={pressed:r,down:i,up:u}}};var En=class{constructor(){this.onInit=null,this.onUpdate=null,this.screen=new fn,this.input=new ln,this._update=this._update.bind(this)}begin(){this.onInit&&this.onInit(),this.screen.init(),requestAnimationFrame(this._update)}_update(){this.input.pollInput(),this.onUpdate&&this.onUpdate(),this.screen.drawScreen(),requestAnimationFrame(this._update)}};e.d(n,"Keys",function(){return pn}),e.d(n,"default",function(){return En}),e.d(n,"Engine",function(){return En}),e.d(n,"Screen",function(){return fn}),e.d(n,"Input",function(){return ln});const pn=r}])});
